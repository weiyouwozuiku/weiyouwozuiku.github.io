---
title: 计算机安全
author: 不二
img: >-
  https://cdn.jsdelivr.net/gh/weiyouwozuiku/weiyouwozuiku.github.io@src/source/_posts/PageImg/计算机安全.jpg
mathjax: true
date: 2021-08-07 12:10:58
tags: 网络安全
categories: Cybersecurity
---

## 哈希洪水攻击

**哈希洪水攻击（Hash-Flooding Attack）**是一种**拒绝服务攻击（Denial of Service）**，一旦后端接口存在合适的攻击面，攻击者就能轻松让整台服务器陷入瘫痪。

### 原理

在各种常用的数据结构里，有些数据结构的“平均运行时间”和“最差运行时间”会差很远，比如**哈希表（Hash Table）**。假设我们想要连续插入n个元素到哈希表中：

- 如果这些元素的键（Key）极少出现相同哈希值，这项任务就只需$O(n)$的时间。
- 如果这些键频繁出现相同的哈希值（频繁发生**碰撞**），这项任务就需要$O(n^2)$的时间。

2003年，Scott A. Crosby 和 Dan S. Wallach 两位研究人员发表了一篇论文：[Denial of Service via Algorithmic Complexity Attacks](https://link.zhihu.com/?target=https%3A//www.usenix.org/legacy/events/sec03/tech/full_papers/crosby/crosby.pdf)。在这篇论文里他们首次提出：既然有些数据结构的最差运行时间这么废物，我们有没有可能通过算法上的漏洞，强行构造出一个最差情况，让服务器把全部的资源都浪费在处理这个最差情况上？

![DJBX33A.jpg](https://cdn.jsdelivr.net/gh/weiyouwozuiku/weiyouwozuiku.github.io@src/source/_posts/计算机安全/DJBX33A.jpg)

![DJBX33A_2.jpg](https://cdn.jsdelivr.net/gh/weiyouwozuiku/weiyouwozuiku.github.io@src/source/_posts/计算机安全/DJBX33A_2.jpg)

这样一来，只要构造出几万个同样哈希的字符串，把它们提交给服务器做哈希表， 就能用很低的成本将服务器打瘫了。

这个成本具体有多低呢？依2011年的实验数据，攻击一台基于Java（Tomcat）的服务器时，仅仅需要6KB/s的流量就能打瘫一颗 Intel i7 处理器，1GB/s的流量可以打瘫 100000 颗 Intel i7 处理器，性价比远超TCP半开连接等传统的拒绝服务攻击。

### 防御

首先介绍一个数学悖论，其之所以被称为悖论。不是因为其矛盾，而是因为其违背了大多数人的尝试。

---

#### 生日悖论

![生日悖论](https://cdn.jsdelivr.net/gh/weiyouwozuiku/weiyouwozuiku.github.io@src/source/_posts/计算机安全/生日悖论.png)

通过上图可以得知，大概在23个人的全体里就有两个人的生日完全相同，并随着人数越多，发生重复的概率越大。通过简单的公式可以看出这点：

$1-P=\frac{365}{365}*\frac{364}{365}*...*\frac{365-n+1}{365}=\frac{365!}{365^n(365-n)!}$

其结果如表：

| n    | 23    | 30    | 40    | 50    | 60    | 100          |
| ---- | ----- | ----- | ----- | ----- | ----- | ------------ |
| P    | 50.7% | 70.6% | 89.1% | 97.0% | 99.4% | 1-3.07*10^-7 |

可以看到 n = 100 远小于 N = 365 时，就已经几乎必然有一对同一天生日，所有人生日两两不同的概率仅一千万分之三。

---

**由生日悖论可知，通过设计更优秀的哈希算法不能让哈希值不发生碰撞。**



